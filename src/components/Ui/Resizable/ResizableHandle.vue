<script setup lang="ts">
import type { SplitterResizeHandleProps } from "reka-ui"
import type { HTMLAttributes } from "vue"
import { SplitterResizeHandle, useForwardProps } from "reka-ui"
import { tv } from "tailwind-variants"
import UiIcon from "../Icon/Icon.vue"

const resizableHandle = tv({
  base: "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
  variants: {
    withHandle: {
      true: "",
    },
  },
})

interface Props extends SplitterResizeHandleProps {
  class?: HTMLAttributes["class"]
  withHandle?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  withHandle: false,
})

const forwarded = useForwardProps(props)
</script>

<template>
  <SplitterResizeHandle
    data-slot="resizable-handle"
    v-bind="forwarded"
    :class="[resizableHandle({ withHandle }), props.class]"
  >
    <div
      v-if="withHandle"
      class="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"
    >
      <UiIcon name="lucide:grip-vertical" class="size-2.5" />
    </div>
  </SplitterResizeHandle>
</template>
